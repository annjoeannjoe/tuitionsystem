{% extends 'sidebar_student.html' %}

{% block content %}
    
<html>
    <head>

    </head>
    <style>
        .container{
            background-color: #F8F8F8;
            padding: 15px 5%; /*Decrease left and right padding*/
            padding-top: 10px;
            padding-bottom: 20px;
            border-radius: 10px;
            max-width: 800px; /*Set maximum width*/
            margin: 0 auto;
        }    

        .containerbutton{
            max-width: 800px;
            background-color: #FFFFFF;
            padding: 15px 5%;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: flex-end;
        }

        .form-control:focus{
            outline: none;
            border-color: #1E78FF;
            box-shadow: 0 0 3px #1E78FF;
        }

        .btn-primary{
            width: 80px; 
            height: 35px;
            font-size: 15px;
            text-align: center;
            display: flex;                
            justify-content: center;
            align-items: center;
        }

        .btn-secondary{
            width: 80px;
            height: 35px;
            font-size: 15px;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 20px;
        }
    </style>

    <body>
        <br>
        <h5><center><b>Update Profile Details</b></center></h5>
        <br>

        <div class="container">
            <form method="POST" id="saveForm" action="{% url 'updateprofile_student' %}" enctype="multipart/form-data">
                {% csrf_token%}
                
                <!--Display Message-->
                {% if messages %}
                {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">
                    {{ message }}
                </div>
               {% endfor %}
               {% endif %}
               
                <div class="mb-3">
                    <br>
                    <label for="full_name" class="form-label"><b>&nbspFull Name</b></label><br>
                    <input type="text" class="form-control" id="full_name" name="full_name" value="{{user.full_name}}" autocomplete="off" required>
           
                    <br>
                    <label for="email" class="form-label"><b>&nbspEmail</b></label>
                    <input type="email" class="form-control" id="email" name="email" value="{{user.email}}" disabled>
                    
                    <br>
                    <label for="school_level" class="form-label"><b>&nbspEducation Level</b></label><br>
                    <select id="school_level" name="school_level" class="form-control" required>
                        <option value="kindergarten" {% if student.school_level == "kindergarten" %}selected{% endif %}>Kindergarten</option>
                        <option value="primary" {% if student.school_level == "primary" %}selected{% endif %}>Primary</option>
                        <option value="secondary" {% if student.school_level == "secondary" %}selected{% endif %}>Secondary</option>
                    </select>
                    <br>
                    
              
                    <div id="primary_school_type" style="display: none;">
                        <label for="primary_school_type_select" class="form-label"><b>&nbspSchool Type</b></label><br>
                        <select id="primary_school_type_select" name="primary_school_type" class="form-control">
                            <option value="" selected disabled hidden>Select School Type</option>
                            <option value="sk" {% if student.primary_school_type == "sk" %}selected{% endif %}>SK</option>
                            <option value="sjkc" {% if student.primary_school_type == "sjkc" %}selected{% endif %}>SJKC</option>
                        </select><br>
                    </div>
                
                    <div id="sk_level" style="display: none;">
                    <label for="sk_level_select" class="form-label"><b>&nbspSK Level</b></label><br>
                    <select id="sk_level_select" name="sk_level" class="form-control">
                        <option value="" selected disabled hidden>Select School Level</option>
                        <option value="standard1" {% if student.sk_level == "standard1" %}selected{% endif %}>Standard 1</option>
                        <option value="standard2" {% if student.sk_level == "standard2" %}selected{% endif %}>Standard 2</option>
                        <option value="standard3" {% if student.sk_level == "standard3" %}selected{% endif %}>Standard 3</option>
                        <option value="standard4" {% if student.sk_level == "standard4" %}selected{% endif %}>Standard 4</option>
                        <option value="standard5" {% if student.sk_level == "standard5" %}selected{% endif %}>Standard 5</option>
                        <option value="standard6" {% if student.sk_level == "standard6" %}selected{% endif %}>Standard 6</option>
                    </select><br>
                    </div>
                
                
                    <div id="sjkc_level" style="display: none;">
                    <label for="sjkc_level_select" class="form-label"><b>&nbspSJKC Level</b></label><br>
                    <select id="sjkc_level_select" name="sjkc_level" class="form-control">
                        <option value="" selected disabled hidden>Select School Level</option>
                        <option value="standard1" {% if student.sjkc_level == "standard1" %}selected{% endif %}>Standard 1</option>
                        <option value="standard2" {% if student.sjkc_level == "standard2" %}selected{% endif %}>Standard 2</option>
                        <option value="standard3" {% if student.sjkc_level == "standard3" %}selected{% endif %}>Standard 3</option>
                        <option value="standard4" {% if student.sjkc_level == "standard4" %}selected{% endif %}>Standard 4</option>
                        <option value="standard5" {% if student.sjkc_level == "standard5" %}selected{% endif %}>Standard 5</option>
                        <option value="standard6" {% if student.sjkc_level == "standard6" %}selected{% endif %}>Standard 6</option>
                    </select><br>
                    </div>
                
                    <div id="secondary_level" style="display: none;">
                    <label for="secondary_level_select" class="form-label"><b>&nbspSMK / SMJK Level</b></label><br>
                    <select id="secondary_level_select" name="secondary_level" class="form-control">
                        <option value="" selected disabled hidden>Select School Level</option>
                        <option value="form1" {% if student.secondary_level == "form1" %}selected{% endif %}>Form 1</option>
                        <option value="form2" {% if student.secondary_level == "form2" %}selected{% endif %}>Form 2</option>
                        <option value="form3" {% if student.secondary_level == "form3" %}selected{% endif %}>Form 3</option>
                        <option value="form4" {% if student.secondary_level == "form4" %}selected{% endif %}>Form 4</option>
                        <option value="form5" {% if student.secondary_level == "form5" %}selected{% endif %}>Form 5</option>
                    </select><br>
                    </div>
            

                    
                    <label for="school_name" class="form-label"><b>&nbspSchool (Full Name Of The School)</b></label>
                    <input type="school_name" class="form-control" id="school_name" name="school_name" value="{{student.school_name}}" autocomplete="off" required>
                    
                    <br>
                    <label for="startdate" class="form-label"><b>Start Date</b></label>
                    <input type="date" class="form-control" id="startdate" name="startdate" value="{{student.startdate|date:'Y-m-d'}}" required>

                    <br>
                    <label for="bankin_receipt" class="form-label"><b>Bank In Transfer Receipt</b></label>
                    <input type="file" class="form-control" id="bankin_receipt" name="bankin_receipt" accept="image/*,.pdf" onchange="validateFile('bankin_receipt','error_message');">
                    <br>
                    <a href="{{ student.bankin_receipt.url }}" target="_blank" class="form-control" style="color: blue">{{student_bankin_receipt_name}}</a>
                    <div id="error_message" style="color: red;"></div>

                    <br>  
                    <label for="classin_phoneno" class="form-label"><b>&nbspRegistered Classin Mobile Number</b></label>
                    <input type="text" class="form-control" id="classin_phoneno" name="classin_phoneno" value="{{student.classin_phoneno}}"autocomplete="off" required>
                   
                    <br>
                    <label for="phoneNo" class="form-label"><b>&nbspParent / Guardian Phone No.1</b></label>
                    <input type="text" class="form-control" id="phone_no" name="phone_no" value="{{user.phone_no}}" autocomplete="off" required>
            
                    <br>
                    <label for="parent_phoneno2" class="form-label"><b>&nbspParent / Guardian Phone No.2 (Optional)</b></label>
                    <input type="text" class="form-control" id="parent_phoneno2" name="parent_phoneno2" value="{{student.parent_phoneno2}}" autocomplete="off" required>
        
                    <br> 
                    <label for="student_phoneno" class="form-label"><b>&nbspStudent Phone No. (Optional)</b></label>
                    <input type="text" class="form-control" id="student_phoneno" name="student_phoneno" value="{{student.student_phoneno}}" autocomplete="off" required>
         
                    <br>
                    <label for="student_ic_number" class="form-label"><b>&nbspStudent IC Number</b></label>
                    <input type="text" class="form-control" id="student_ic_number" name="student_ic_number" value="{{student.student_ic_number}}" disabled>
                     
                    <br>
                    <label for="student_ic_photo" class="form-label"><b>Student IC (Snap Front IC)</b></label>
                    <a href="{{ student.student_ic_photo.url }}" target="_blank" class="form-control" style="color: blue; background-color: #E9ECEF;" >{{student_ic_photo_name}}</a>

                    <br>
                    <label for="student_photo" class="form-label"><b>Student Photo (Passport Size Photo)</b></label>
                    <a href="{{ student.student_photo.url }}" target="_blank" class="form-control" style="color: blue; background-color: #E9ECEF;" >{{student_photo_name}}</a>
                    
                    
                    <br><br>
                    <label for="studenthomeaddress" class="form-label"><b>&nbspHome Address</b></label>
                    <br>
                    <label for="street1" class="form-label"><b>&nbspStreet 1</b></label>
                    <input type="text" class="form-control" id="street1" name="street1" value="{{user.street1}}" autocomplete="off" required>
                    <br>
                    <label for="street2" class="form-label"><b>&nbspStreet 2</b></label>
                    <input type="text" class="form-control" id="street2" name="street2" value="{{user.street2}}" autocomplete="off" required>
                    <br>
                    <label for="city" class="form-label"><b>&nbspCity</b></label>
                    <input type="text" class="form-control" id="city" name="city" value="{{user.city}}" autocomplete="off" required>
                    <br>
                    <label for="postalcode" class="form-label"><b>&nbspPostal Code</b></label>
                    <input type="text" class="form-control" id="postalcode" name="postalcode" value="{{user.postalcode}}" autocomplete="off" required>
                    <br>
                    <label for="state" class="form-label"><b>&nbspState</b></label>
                    <input type="text" class="form-control" id="state" name="state" value="{{user.state}}" autocomplete="off" required>
                </div>
        </div>
       
        <div class="containerbutton">
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#confirmationModal">Save</button>
        </div>
        </form>

        <!--Save Confirmation Modal-->
        <div class="modal fade" id="confirmationModal" tabindex="-1" role="dialog" aria-labelledby="confirmationModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel"><b>Confirm Save</b></h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        Are you sure want to save the changes?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" style="margin-right: 10px;">Cancel</button>
                        <button type="submit" form= "saveForm" class="btn btn-primary">Save</a>
                    </div>
                </div>
            </div>
        </div>

    </body>
    
    <script>

        const educationLevelSelect = document.getElementById('school_level');
        const schoolTypeDiv = document.getElementById('primary_school_type');
        const schoolTypeSelect = document.getElementById('primary_school_type_select');
        const skLevelDiv = document.getElementById('sk_level');
        const skLevelSelect = document.getElementById('sk_level_select');
        const sjkcLevelDiv = document.getElementById('sjkc_level');
        const sjkcLevelSelect = document.getElementById('sjkc_level_select');
        const secondaryLevelDiv = document.getElementById('secondary_level');
        const secondaryLevelSelect = document.getElementById('secondary_level_select');
        
        
        educationLevelSelect.addEventListener('change', () => {
            if (educationLevelSelect.value === 'kindergarten'){
                schoolTypeDiv.style.display = 'none';
                skLevelDiv.style.display = 'none';
                sjkcLevelDiv.style.display = 'none';
                secondaryLevelDiv.style.display = 'none';

            }else if (educationLevelSelect.value === 'primary') {
                schoolTypeDiv.style.display = 'block';
                skLevelDiv.style.display = 'none';
                sjkcLevelDiv.style.display = 'none';
                secondaryLevelDiv.style.display = 'none';

                if(schoolTypeSelect.value === 'sk'){
                    schoolTypeDiv.style.display = 'block';
                    skLevelDiv.style.display = 'block';
                    sjkcLevelDiv.style.display = 'none';
                    secondaryLevelDiv.style.display = 'none';
                }else if (schoolTypeSelect.value === 'sjkc'){
                    schoolTypeDiv.style.display = 'block';
                    skLevelDiv.style.display = 'none';
                    sjkcLevelDiv.style.display = 'block';
                    secondaryLevelDiv.style.display = 'none';
                }
           
            } 
            else if (educationLevelSelect.value === 'secondary'){
                schoolTypeDiv.style.display = 'none';
                skLevelDiv.style.display = 'none';
                sjkcLevelDiv.style.display = 'none';
                secondaryLevelDiv.style.display = 'block';
            }
        });

        // Define a function to show the appropriate section based on the selected education level
        function showAppropriateSection(){
            if (educationLevelSelect.value === 'primary'){
                schoolTypeDiv.style.display = 'block';
        
                if(schoolTypeSelect.value === 'sk'){
                    schoolTypeDiv.style.display = 'block';
                    skLevelDiv.style.display = 'block';
                    sjkcLevelDiv.style.display = 'none';
                    secondaryLevelDiv.style.display = 'none';
                }else if (schoolTypeSelect.value === 'sjkc'){
                    schoolTypeDiv.style.display = 'block';
                    skLevelDiv.style.display = 'none';
                    sjkcLevelDiv.style.display = 'block';
                    secondaryLevelDiv.style.display = 'none';
                }
            }else if (educationLevelSelect.value === 'secondary'){
                secondaryLevelDiv.style.display = 'block';
            }
        }

        // Show the appropriate section initially
        showAppropriateSection();

        // Add an event listener to the educationLevelSelect
        educationLevelSelect.addEventListener('change',() =>{
            showAppropriateSection();
        });

        schoolTypeSelect.addEventListener('change',() =>{
            showAppropriateSection();
        })

        function hideSuccessMessage() {
            var successMessage = document.querySelector(".alert-success");
            if (successMessage) {
                setTimeout(function() {
                    successMessage.style.display = "none";
                }, 2000); // Adjust the delay (in milliseconds) as needed (e.g., 5000ms = 5 seconds)
            }
        }
        // Call the hideSuccessMessage function when the page loads
        window.onload = hideSuccessMessage;

</script>
</html>
 
{% endblock %}